<!DOCTYPE html>
<html>
<head>
	<title>Search Results</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" type="text/css" href="style.css">
	<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
	<link rel="stylesheet" href="https://use.typekit.net/znk3xkz.css">
</head>
<body>

<!-- header -->
<div id="mySidenav" class="sidenav">
  	<a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
	<a href="index.html">Home</a>
	<a href="about.html">Why Us</a>
	<a href="gift.html">Gift it</a>
	<a href="https://www.etsy.com">Shop</a>
</div>

<div class="head">
	<span onclick="openNav()">+</span>
	<a href="you.html">For You</a>
</div>
<!-- header -->

<!-- content -->
<div class="results">
	<h1>Assisty's picks for you</h1>
  <a href="etsy2.html" class="stylebutton save">save results</a>
</div>

<div class="container"></div>
<!-- content -->

<script>
	function openNav() {
    document.getElementById("mySidenav").style.width = "16vw";
}

function closeNav() {
    document.getElementById("mySidenav").style.width = "0";
}

styles = sessionStorage.party1+","+sessionStorage.party2;
console.log(styles)
othertags = sessionStorage.colors+","+sessionStorage.len+","+sessionStorage.len+","+sessionStorage.len+","+sessionStorage.showoff+","+sessionStorage.fit;
console.log(othertags)
var data = {
  "size":12,
  "query": {
    "bool": {
      "must": [
        { "match": { "othertags": othertags } },
        { "match": { "occastion": sessionStorage.occasion } },
        { "match": { "primaryStyleTag": styles } }
      ]
    }
  }
};
console.log(data);
$.ajax({ 
    type: 'POST', 
    url: 'https://d5f2adfb8c7e4bf5a2cc02fc054a74ac.us-east-1.aws.found.io:9243/assisty/_search?pretty=true', 
	data: JSON.stringify(data),
  dataType : 'json',
  contentType: 'application/json',
    headers: {
    	"Authorization": "Basic " + btoa('elastic' + ":" + '3K37pef3Y4YCu9P6PGT1ZRbH')
  	},
    success: function (data) { 

          $.each( data.hits.hits, function( index, value ) {
  	console.log(value._source);
      var shorterName = jQuery.trim(value._source.name).substring(0, 22)+ "...";
  			$(".container").append("<a href=" + value._source.itemurl + ">" + "<img class='prodimg' src=" + value._source.imageUrl + "><p class='prodname'>" +  shorterName + "</p><p class='seller'>" + value._source.sellerName + "</p><p class='price'>$" + value._source.price + "</p></a>");
 		 });
    }
});
sessionStorage.clear();
</script>
</body>
</html>
